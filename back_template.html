<!-- Back Template -->
{{FrontSide}}
<hr id="answer">
<div id="back" class="card" data='{{json_data}}'></div>

<script>
  var jsonData = JSON.parse(unescape(document.getElementById("back").getAttribute("data")));

  var titleContent = `<div class="word-title">
    <h1>${jsonData.japanese[0].word} (${jsonData.japanese[0].reading})</h1>`;

  // Process tags like common word and Wanikani level
  var tagsContent = [
    jsonData.is_common ? 'Common word' : '',
    jsonData.tags.length > 0 ? `Wanikani level ${jsonData.tags[0].substr(8)}` : ''
  ].filter(tag => tag).join(', ');

  titleContent += `<span class="tags">${tagsContent}</span></div>`;

  var definitionsContent = '<div class="definitions">';
  jsonData.senses.forEach(function(sense, index) {
    definitionsContent += `<div class="definition">
      <div class="parts-of-speech">${sense.parts_of_speech.join(', ')}</div>
      <strong>${index + 1}. ${sense.english_definitions.join(', ')}</strong>`;

    if (sense.restrictions.length > 0) {
      sense.restrictions.forEach(function(restriction) {
        definitionsContent += `<p class="restriction">(Only applies to ${restriction})</p>`;
      });
    }

    definitionsContent += '</div>';
  });
  definitionsContent += '</div>';

  var otherFormsContent = '<div class="other-forms">Other forms: ' +
    jsonData.japanese.slice(1).map(j => `${j.word} [${j.reading}]`).join(', ') + '</div>';

  var finalContent = `<div class="jisho-style">${titleContent}${definitionsContent}${otherFormsContent}</div>`;

  document.getElementById('back').innerHTML = finalContent;
</script>


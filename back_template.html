<!-- Back Template -->
{{FrontSide}}
<hr id="answer">
<div id="back" class="card" data='{{json_data}}'></div>

<script>
  var jsonData = JSON.parse(unescape(document.getElementById("back").getAttribute("data")));

  // Title section with word and reading
  var titleContent = `<div class="word-title">
    <h1>${jsonData.japanese[0].word} (${jsonData.japanese[0].reading})</h1>
    <span class="tags">${jsonData.is_common ? 'Common word, ' : ''} Wanikani level ${jsonData.tags[0].substr(8)}</span>
  </div>`;

  // Definitions and details section
  var definitionsContent = '<div class="definitions">';
  jsonData.senses.forEach(function(sense, index) {

    // Skip if parts_of_speech includes "Wikipedia definition"
    if (sense.parts_of_speech.includes("Wikipedia definition")) {
      return;
    }

    definitionsContent += `<div class="definition">
      <div class="part-of-speech">${sense.parts_of_speech[0]}</div>
      <strong>${index + 1}. ${sense.english_definitions.join(', ')}</strong>`;
    if (sense.restrictions.length > 0) {
      definitionsContent += `<p>(Only applies to ${jsonData.japanese[0].reading})</p>`;
    }
    definitionsContent += `</div>`;
  });
  definitionsContent += '</div>';

  // Other forms and notes section
  var otherFormsContent = `<div class="other-forms">
    Other forms: ${jsonData.japanese.map(j => `${j.word} [${j.reading}]`).join(', ')}
  </div>`;

  var notesContent = `<div class="notes">
    Notes: Out-dated kanji or kanji usage.
  </div>`;

  // Combining all parts into the final content
  var finalContent = `<div class="jisho-style">${titleContent}${definitionsContent}${otherFormsContent}${notesContent}</div>`;

  document.getElementById('back').innerHTML = finalContent;
</script>
